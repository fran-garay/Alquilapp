<!DOCTYPE html>
<html>
  <head>
    <title>Alquilapp</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <%# <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script> %>
  </head>


  <body>



    <div class="d-flex flex-column border border-5 border-danger element-mobile-100vh" >

      <%= render "users/partials/menu" %>


    <div class="container z1" style="margin-top:1vh; flex-grow:1;">
      <%= yield %>
    </div>

    <%= render "users/partials/footer" %>

    </div>

  </body>


  <script>

    // get user city bases on coordinates
    // function getCity(lat, lon) {
    //   var xhttp = new XMLHttpRequest();
    //   xhttp.onreadystatechange = function() {
    //     if (this.readyState == 4 && this.status == 200) {
    //       var result = JSON.parse(this.responseText);
    //       document.getElementById("myCity").innerHTML = "üìç " + removePartido(result.address.state_district);
    //     }
    //   };
    //   xhttp.open("GET", "https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat="+lat+"&lon="+lon, true);
    //   xhttp.send();
    // }

    // get user city bases on coordinates using jquery
    function getCity(lat, lon) {
      $.ajax({
        url: "https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat="+lat+"&lon="+lon,
        type: "GET",
        success: function(result){
          console.log(result);
          document.getElementById("myCity").innerHTML = "üìç " + removePartido(result.address.state_district);
        }
      });
    }


    function removePartido(city){
      if(city.includes("Partido de ")){
        city = city.replace("Partido de ", "");
      }
      return city;
    }


    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
    } else {
       document.getElementById("myCity").innerHTML = "No te puedo encontrar";
    }

    function showPosition(position) {
      getCity(position.coords.latitude, position.coords.longitude);
    }

    // function getLocation() {

    // }


    let vh = window.innerHeight * 0.01;
    // Then we set the value in the --vh custom property to the root of the document
    document.documentElement.style.setProperty('--vh', `${vh}px`);



    // delete myalert after 5 seconds
    setTimeout(function() {
      var element = document.getElementsByClassName("alert");
      element[0].parentNode.removeChild(element[0]);
    }, 3000);



    // hide and show navbar when button b is pressed
    var b = document.getElementById("b");
    var navbar = document.getElementById("nav");
    b.addEventListener("click", function() {
      if (navbar.style.display === "none") {
        navbar.style.display = "block";
      } else {
        navbar.style.display = "none";
      }
    });

    function openNav() {
      document.getElementById("myNav").style.width = "65%";
    }

    function closeNav() {
      document.getElementById("myNav").style.width = "0%";
    }

  </script>
</html>
